#!/bin/bash

# ðŸ“¦ Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° Ñ Ð¾Ð±Ñ‰Ð¸Ð¼Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑÐ¼Ð¸

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸ Ð¸ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÑÑÑ‹Ð»ÐºÐ¸
backup_and_link() {
    local source_file=$1
    local target_file=$2
    local backup_file="${target_file}.bak_$(date +%Y%m%d%H%M%S)"

    if [ -L "$target_file" ]; then
        echo "ðŸ”— Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÑÑ‹Ð»ÐºÐ° ${target_file} ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚. ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼."
    elif [ -f "$target_file" ]; then
        echo "ðŸ“‘ ÐÐ°Ð¹Ð´ÐµÐ½ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ñ„Ð°Ð¹Ð» ${target_file}."
        echo "   -> Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½ÑƒÑŽ ÐºÐ¾Ð¿Ð¸ÑŽ Ð² ${backup_file}"
        mv "$target_file" "$backup_file"
        echo "   -> Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð½Ð¾Ð²ÑƒÑŽ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÑƒÑŽ ÑÑÑ‹Ð»ÐºÑƒ..."
        ln -s "$source_file" "$target_file"
    else
        echo "ðŸ”— Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÑƒÑŽ ÑÑÑ‹Ð»ÐºÑƒ Ð´Ð»Ñ ${target_file}..."
        ln -s "$source_file" "$target_file"
    fi
}

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð»Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°
command_exists() {
    command -v "$1" >/dev/null 2>&1
}